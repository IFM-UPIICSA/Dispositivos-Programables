;ESTE PROGRAMA REALIZA LA SUMA O RESTA DE 3 BITS EN PARALELO, MOSTANDO EL RESULTADO CON CARRY
    LIST P=18F4550
    #INCLUDE<P18F4550.INC>
                      
#DEFINE   DATO    H'04'
#DEFINE   DATO1   H'05'
#DEFINE CERO	B'00111111'
#DEFINE UNO	B'00110000'
#DEFINE DOS	B'01011011'
#DEFINE TRES	B'01001111'
#DEFINE CUATRO  B'01100110'
#DEFINE CINCO	B'01101101'
#DEFINE SEIS	B'01111101'
#DEFINE SIETE	B'00000111'
#DEFINE OCHO	B'01111111'
#DEFINE NUEVE	B'01100111'
#DEFINE DIEZ	B'01110111'
#DEFINE ONCE	B'01111100'
#DEFINE DOCE	B'00111001'
#DEFINE TRECE	B'01011110'
#DEFINE CATORCE B'01111001'
#DEFINE MUNO    B'10110000'
#DEFINE MDOS    B'11011011'
#DEFINE MTRES   B'11001111'
#DEFINE MCUATRO B'11100110'
#DEFINE MCINCO  B'01101101'
#DEFINE MSEIS   B'11111101'
#DEFINE MSIETE  B'11111111'
ORG     H'00'
	  
SETTING	CLRF	PORTA		;PCL = 0
	CLRF	LATA		;PCL = 2
	SETF	TRISA		;PCL = 4
	CLRF	PORTD
	CLRF	TRISD
	BCF	PORTB,0
	MOVLW	.15
	MOVWF	ADCON1
	MOVLW	.7
	MOVWF	CMCON
	  
SELECT    BTFSS   PORTB,RA0
	  GOTO    RESTA
	  GOTO    SUMA
	  
TABLA	ADDWF	PCL,F		;W=PA PCL=28+W
	RETLW	CERO		;PCL=30 W=3F
	RETLW	UNO
	RETLW	DOS
	RETLW	TRES
	RETLW	CUATRO
	RETLW	CINCO
	RETLW	SEIS
	RETLW	SIETE
	RETLW	OCHO
	RETLW	NUEVE
	RETLW	DIEZ
	RETLW	ONCE
	RETLW	DOCE
	RETLW	TRECE
	RETLW	CATORCE
	
TABLA2  ADDWF	PCL,F		;W=PA PCL=28+W
	RETLW	CERO		;PCL=30 W=3F
	RETLW	MUNO
	RETLW	MDOS
	RETLW	MTRES
	RETLW	MCUATRO
	RETLW	MCINCO
	RETLW	MSEIS
	RETLW	MSIETE
	  
DECO    MOVFF   DATO,WREG
	MULLW	.2
	MOVF	PRODL,W
	CALL	TABLA		;PC VE A LA DIRECCION LLAMADA TABLA Y CUANDO EN-
				;CUENTRES "RETURN" REGRESAS AQUI PCL = 22
	MOVWF	PORTD
	GOTO	SELECT
	
DECO2   MOVFF   DATO,WREG
	MULLW	.2
	MOVF	PRODL,W
	CALL	TABLA2
	
	MOVWF	PORTD
	GOTO	SELECT

	
SUMA      MOVFF   PORTA,DATO
	  MOVFF   PORTA,DATO1
	  RRNCF   DATO1,F
	  RRNCF   DATO1,F
	  RRNCF   DATO1,F
	  MOVLW   B'00000111'
	  ANDWF   DATO,F
	  ANDWF   DATO1,W
	  ADDWF   DATO,F
	  GOTO    DECO
	  
RESTA     MOVFF   PORTA,DATO
	  MOVFF   PORTA,DATO1
	  RRNCF   DATO1,F
	  RRNCF   DATO1,F
	  RRNCF   DATO1,F
	  MOVLW   B'00000111'
	  ANDWF   DATO,F
	  ANDWF   DATO1,W
	  SUBWF   DATO,F
	  BTFSC   STATUS,N
	  GOTO    NEGAR
	  GOTO    DECO
	  
NEGAR    NEGF    DATO
	 GOTO    DECO2
	END